clear all
clc

% Come prima cosa scrivo i valori dei dati geometrici
z1=1; z3=4; z4=15; delta=40*pi/180;

% Scrivo poi il valore della coordinata indipendente in gradi
q=120*pi/180;

% La prima cosa che bisogna fare ora è calcolare C e B
C=z1*[cos(q), sin(q)]';
B=[z4,0];

% Posso dunque calcolare il modulo di zt
zt=norm(B-C);

% Analizzando la diade RPR posso fare i seguenti calcoli:
HB=z3*sin(delta);
HD=z3*cos(delta);

alfa=asin(HB/zt);
phi_t=atan2(B(2)-C(2), B(1)-C(1));

% Ora posso calcolarmi la prima incognita phi2
phi2=phi_t+alfa;

% E la seconda incognita z2, finendo così la cinematica del meccanismo
z2=zt*cos(alfa)-HD;


% PLOTTO I RISULTATI

% Calcolo come prima cosa le coordinate del punto D
D=[C(1)+z2*cos(phi2), C(2)+z2*sin(phi2)];

% Apro la figura 1
figure(1)

% Mantengo aperta la figura 1 per sovrapporre le linee
hold on

% Faccio si che gli assi x e y siano uguali
axis equal

% Plot_1: primo parametro=vettore con solo le componenti x dei due punti...
% estremi della retta (primo vettore=[Ox, Cx]) secondo parametro=vettore...
% con solo le componenti y dei due punti estremi della retta (secondo vettore=[Oy, Cy])
plot([0, C(1)], [0, C(2)], 'b')

% Plot_2: primo parametro=vettore con solo le componenti x dei due punti...
% estremi della retta (primo vettore=[Cx, Dx]) secondo parametro=vettore...
% con solo le componenti y dei due punti estremi della retta (secondo vettore=[Cy, Dy])
plot([C(1), D(1)], [C(2), D(2)], 'b')

% Plot_3: primo parametro=vettore con solo le componenti x dei due punti...
% estremi della retta (primo vettore=[Dx, Bx]) secondo parametro=vettore...
% con solo le componenti y dei due punti estremi della retta (secondo vettore=[Dy, By])
plot([D(1), B(1)], [D(2), B(2)], 'b')

% Plot_4: primo parametro=vettore con solo le componenti x dei due punti...
% estremi della retta (primo vettore=[Bx, Ox]) secondo parametro=vettore...
% con solo le componenti y dei due punti estremi della retta (secondo vettore=[By, Oy])
plot([B(1), 0], [B(2), 0], 'b')
